<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Annotate GRangesList from GRangesList objects — annotateGRLfromGRL • splicejam</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Annotate GRangesList from GRangesList objects — annotateGRLfromGRL" />

<meta property="og:description" content="Annotate GRangesList from GRangesList objects" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">splicejam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.49.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-rnaseq-workflow.html">Splicejam basic RNAseq workflow</a>
    </li>
    <li>
      <a href="../articles/create-a-sashimi-plot.html">Create a Sashimi Plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jmw86069/splicejam">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Annotate GRangesList from GRangesList objects</h1>
    <small class="dont-index">Source: <a href='https://github.com/jmw86069/splicejam/blob/master/R/jambio-tx.R'><code>R/jambio-tx.R</code></a></small>
    <div class="hidden name"><code>annotateGRLfromGRL.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Annotate GRangesList from GRangesList objects</p>
    
    </div>

    <pre class="usage"><span class='fu'>annotateGRLfromGRL</span>(<span class='no'>GRL1</span>, <span class='no'>GRL2</span>, <span class='kw'>annoName1</span> <span class='kw'>=</span> <span class='st'>"name"</span>, <span class='kw'>annoName2</span> <span class='kw'>=</span> <span class='st'>"name"</span>,
  <span class='kw'>grlOL</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>add_grl_name</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>returnType</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"GRL"</span>, <span class='st'>"GR"</span>),
  <span class='kw'>splitColname</span> <span class='kw'>=</span> <span class='no'>annoName1</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>GRL1</th>
      <td><p>GRangesList query</p></td>
    </tr>
    <tr>
      <th>GRL2</th>
      <td><p>GRangesList subject, used to add annotations to <code>GRL1</code></p></td>
    </tr>
    <tr>
      <th>annoName1</th>
      <td><p>character value indicating either the colname of
<code>values(GRL1)</code> to use as the name, or if <code>"name"</code> then it uses
<code><a href='https://www.rdocumentation.org/packages/base/topics/names'>names(GRL1)</a></code>.</p></td>
    </tr>
    <tr>
      <th>annoName2</th>
      <td><p>character value indicating either the colname of
<code>values(GRL2)</code> to use as the name, or if <code>"name"</code> then it uses
<code><a href='https://www.rdocumentation.org/packages/base/topics/names'>names(GRL2)</a></code>.</p></td>
    </tr>
    <tr>
      <th>grlOL</th>
      <td><p>overlap result (optional) from <code><a href='https://www.rdocumentation.org/packages/GenomicRanges/topics/findOverlaps-methods'>GenomicRanges::findOverlaps()</a></code>
for these same GRangesList objects, used to save time by not re-running
<code><a href='https://www.rdocumentation.org/packages/GenomicRanges/topics/findOverlaps-methods'>GenomicRanges::findOverlaps()</a></code> again.</p></td>
    </tr>
    <tr>
      <th>add_grl_name</th>
      <td><p>logical indicating whether to add the names of each
GRangesList object to the output object, useful for tracking the
annotations to the source data.</p></td>
    </tr>
    <tr>
      <th>returnType</th>
      <td><p>character value indicating whether to return
GRangesList "GRL" or GRange "GR" object.</p></td>
    </tr>
    <tr>
      <th>splitColname</th>
      <td><p>character value used internally to indicate how
to split the resulting GRanges annotated data back to GRangesList.
Almost always, this value should be identical to <code>annoName1</code> which
will split the resulting GRanges back into the identical input
GRangesList.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating whether to print verbose output.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments are passed to <code><a href='annotateGRfromGR.html'>annotateGRfromGR()</a></code>.
To customize the aggregation functions, supply <code>numShrinkFunc</code> or
<code>stringShrinkFunc</code> as described in <code><a href='annotateGRfromGR.html'>annotateGRfromGR()</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>GRangesList object with the same length and lengths as
the input <code>GRL1</code>, with annotation columns added from <code>GRL2</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function extends <code><a href='annotateGRfromGR.html'>annotateGRfromGR()</a></code> for the special case
of GRangesList objects. It requires both GRangesList objects have
identical length, and assumes both are in equivalent order.
It then restricts all overlapping annotations to those where the
query and subject are the same original GRangesList index.</p>
<p>This function is particularly useful following an operation on
a GRangesList object that otherwise removes all annotations in
<code>values(GRL1)</code>, for example <code><a href='https://www.rdocumentation.org/packages/GenomicRanges/topics/inter-range-methods'>GenomicRanges::reduce()</a></code> or
<code><a href='https://www.rdocumentation.org/packages/GenomicRanges/topics/intra-range-methods'>GenomicRanges::flank()</a></code>. This function can be used to re-annotate
the resulting features using the original GRangesList object.</p>
<p>Note that annotations are added at the level of individual GRanges
entries, equivalent to <code>values(GRL1@unlistData)</code>. This function does
not currently apply annotations at the GRangesList level, thus
it does not use <code>values(GRL2)</code> if they exist.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other jam GRanges functions: <code><a href='addGRLgaps.html'>addGRLgaps</a></code>,
  <code><a href='addGRgaps.html'>addGRgaps</a></code>, <code><a href='annotateGRfromGR.html'>annotateGRfromGR</a></code>,
  <code><a href='assignGRLexonNames.html'>assignGRLexonNames</a></code>,
  <code><a href='closestExonToJunctions.html'>closestExonToJunctions</a></code>,
  <code><a href='combineGRcoverage.html'>combineGRcoverage</a></code>,
  <code><a href='exoncov2polygon.html'>exoncov2polygon</a></code>,
  <code><a href='findOverlapsGRL.html'>findOverlapsGRL</a></code>,
  <code><a href='getFirstStrandedFromGRL.html'>getFirstStrandedFromGRL</a></code>,
  <code><a href='getGRLgaps.html'>getGRLgaps</a></code>,
  <code><a href='getGRcoverageFromBw.html'>getGRcoverageFromBw</a></code>,
  <code><a href='getGRgaps.html'>getGRgaps</a></code>, <code><a href='grl2df.html'>grl2df</a></code>,
  <code><a href='make_ref2compressed.html'>make_ref2compressed</a></code>, <code><a href='sortGRL.html'>sortGRL</a></code>,
  <code><a href='spliceGR2junctionDF.html'>spliceGR2junctionDF</a></code>,
  <code><a href='stackJunctions.html'>stackJunctions</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>gr12</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>GenomicRanges</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/GenomicRanges/topics/GRanges-class'>GRanges</a></span>(
   <span class='kw'>seqnames</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"chr1"</span>, <span class='st'>"chr2"</span>, <span class='st'>"chr1"</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>3</span>)),
   <span class='kw'>ranges</span><span class='kw'>=</span><span class='kw pkg'>IRanges</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/IRanges/topics/IRanges-constructor'>IRanges</a></span>(
      <span class='kw'>start</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>400</span>, <span class='fl'>500</span>, <span class='fl'>300</span>, <span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>400</span>, <span class='fl'>600</span>),
      <span class='kw'>width</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>100</span>,<span class='fl'>150</span>,<span class='fl'>50</span>, <span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>100</span>, <span class='fl'>50</span>,<span class='fl'>200</span>,<span class='fl'>50</span>)
   ),
   <span class='kw'>strand</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"+"</span>, <span class='st'>"-"</span>, <span class='st'>"+"</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>3</span>)),
   <span class='kw'>gene_name</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"GeneA"</span>, <span class='st'>"GeneB"</span>, <span class='st'>"GeneC"</span>), <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>3</span>)
)

<span class='co'># Now split into GRangesList</span>
<span class='no'>grl1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>GenomicRanges</span><span class='kw ns'>::</span><span class='fu'>split</span>(<span class='no'>gr12</span>[,<span class='fl'>0</span>],
   <span class='kw pkg'>GenomicRanges</span><span class='kw ns'>::</span><span class='fu'>values</span>(<span class='no'>gr12</span>)$<span class='no'>gene_name</span>);
<span class='no'>grl2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>GenomicRanges</span><span class='kw ns'>::</span><span class='fu'>split</span>(<span class='no'>gr12</span>,
   <span class='kw pkg'>GenomicRanges</span><span class='kw ns'>::</span><span class='fu'>values</span>(<span class='no'>gr12</span>)$<span class='no'>gene_name</span>);

<span class='co'># The first object is a GRangesList with no annotations</span>
<span class='no'>grl1</span>;</div><div class='output co'>#&gt; GRangesList object of length 3:
#&gt; $GeneA 
#&gt; GRanges object with 3 ranges and 0 metadata columns:
#&gt;       seqnames    ranges strand
#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;
#&gt;   [1]     chr1   100-199      +
#&gt;   [2]     chr1   200-349      +
#&gt;   [3]     chr1   400-449      +
#&gt; 
#&gt; $GeneB 
#&gt; GRanges object with 3 ranges and 0 metadata columns:
#&gt;       seqnames  ranges strand
#&gt;   [1]     chr2 500-549      -
#&gt;   [2]     chr2 300-349      -
#&gt;   [3]     chr2 100-199      -
#&gt; 
#&gt; $GeneC 
#&gt; GRanges object with 3 ranges and 0 metadata columns:
#&gt;       seqnames  ranges strand
#&gt;   [1]     chr1 200-249      +
#&gt;   [2]     chr1 400-599      +
#&gt;   [3]     chr1 600-649      +
#&gt; 
#&gt; -------
#&gt; seqinfo: 2 sequences from an unspecified genome; no seqlengths</div><div class='input'>
<span class='co'># The second object is a GRangesList with annotation,</span>
<span class='co'># assumed to be in the same order</span>
<span class='no'>grl2</span>;</div><div class='output co'>#&gt; GRangesList object of length 3:
#&gt; $GeneA 
#&gt; GRanges object with 3 ranges and 1 metadata column:
#&gt;       seqnames    ranges strand |   gene_name
#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;
#&gt;   [1]     chr1   100-199      + |       GeneA
#&gt;   [2]     chr1   200-349      + |       GeneA
#&gt;   [3]     chr1   400-449      + |       GeneA
#&gt; 
#&gt; $GeneB 
#&gt; GRanges object with 3 ranges and 1 metadata column:
#&gt;       seqnames  ranges strand | gene_name
#&gt;   [1]     chr2 500-549      - |     GeneB
#&gt;   [2]     chr2 300-349      - |     GeneB
#&gt;   [3]     chr2 100-199      - |     GeneB
#&gt; 
#&gt; $GeneC 
#&gt; GRanges object with 3 ranges and 1 metadata column:
#&gt;       seqnames  ranges strand | gene_name
#&gt;   [1]     chr1 200-249      + |     GeneC
#&gt;   [2]     chr1 400-599      + |     GeneC
#&gt;   [3]     chr1 600-649      + |     GeneC
#&gt; 
#&gt; -------
#&gt; seqinfo: 2 sequences from an unspecified genome; no seqlengths</div><div class='input'>
<span class='fu'>annotateGRLfromGRL</span>(<span class='no'>grl1</span>, <span class='no'>grl2</span>);</div><div class='output co'>#&gt; GRangesList object of length 3:
#&gt; $GeneA 
#&gt; GRanges object with 3 ranges and 1 metadata column:
#&gt;           seqnames    ranges strand |           X
#&gt;              &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;
#&gt;   grl1_v1     chr1   100-199      + |       GeneA
#&gt;   grl1_v2     chr1   200-349      + |       GeneA
#&gt;   grl1_v3     chr1   400-449      + |       GeneA
#&gt; 
#&gt; $GeneB 
#&gt; GRanges object with 3 ranges and 1 metadata column:
#&gt;           seqnames  ranges strand |     X
#&gt;   grl1_v4     chr2 500-549      - | GeneB
#&gt;   grl1_v5     chr2 300-349      - | GeneB
#&gt;   grl1_v6     chr2 100-199      - | GeneB
#&gt; 
#&gt; $GeneC 
#&gt; GRanges object with 3 ranges and 1 metadata column:
#&gt;           seqnames  ranges strand |     X
#&gt;   grl1_v7     chr1 200-249      + | GeneC
#&gt;   grl1_v8     chr1 400-599      + | GeneC
#&gt;   grl1_v9     chr1 600-649      + | GeneC
#&gt; 
#&gt; -------
#&gt; seqinfo: 2 sequences from an unspecified genome; no seqlengths</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward, Shannon Farris.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

