<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Define detected transcripts — defineDetectedTx • splicejam</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Define detected transcripts — defineDetectedTx" />

<meta property="og:description" content="Define detected transcripts" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">splicejam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.13.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-rnaseq-workflow.html">Splicejam basic RNAseq workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jmw86069/splicejam">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Define detected transcripts</h1>
    <small class="dont-index">Source: <a href='https://github.com/jmw86069/splicejam/blob/master/R/jambio-tx.R'><code>R/jambio-tx.R</code></a></small>
    <div class="hidden name"><code>defineDetectedTx.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Define detected transcripts</p>
    
    </div>

    <pre class="usage"><span class='fu'>defineDetectedTx</span>(<span class='kw'>iMatrixTx</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>iMatrixTxGrp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>iMatrixTxTPM</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>iMatrixTxTPMGrp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>tx2geneDF</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>cutoffTxPctMax</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>cutoffTxExpr</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>cutoffTxTPMExpr</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>useMedian</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>iMatrixTx</th>
      <td><p>numeric matrix of read counts (or pseudocounts) with
transcript rows and sample columns. This data is assumed to be
log2-transformed, and if any value is higher than 50, it will
be log2-transformed with <code><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log2(x+1)</a></code>.</p></td>
    </tr>
    <tr>
      <th>iMatrixTxGrp</th>
      <td><p>numeric matrix of read counts averaged by sample
group. If this matrix is not provided, it will be calculated
from <code>iMatrixTx</code>
using <code><a href='https://www.rdocumentation.org/packages/jamba/topics/rowGroupMeans'>jamba::rowGroupMeans()</a></code> and the <code>groups</code> parameter.
This data is assumed to be
log2-transformed, and if any value is higher than 50, it will
be log2-transformed with <code><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log2(x+1)</a></code>.</p></td>
    </tr>
    <tr>
      <th>iMatrixTxTPM</th>
      <td><p>numeric matrix of TPM values, with sample columns
and transcript rows. Note that if this parameter is not supplied,
the counts in <code>iMatrixTx</code> will be used to determine the percent
max isoform expression.</p></td>
    </tr>
    <tr>
      <th>iMatrixTxTPMGrp</th>
      <td><p>numeric matrix of TPM values averaged by sample
group. If this matrix is not provided, it will be calculated
from <code>iMatrixTxTPM</code>
using <code><a href='https://www.rdocumentation.org/packages/jamba/topics/rowGroupMeans'>jamba::rowGroupMeans()</a></code> and the <code>groups</code> parameter.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>vector of group labels, either as character vector
or factor. It should be named by <code><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames(iMatrixTx)</a></code>.</p></td>
    </tr>
    <tr>
      <th>tx2geneDF</th>
      <td><p>data.frame with colnames including
<code><a href='https://www.rdocumentation.org/packages/base/topics/c'>c("transcript_id","gene_name")</a></code>, where the values in the
<code>"transcript_id"</code> column must match the <code><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>rownames(iMatrixTx)</a></code>.</p></td>
    </tr>
    <tr>
      <th>cutoffTxPctMax</th>
      <td><p>numeric value scaled from 0 to 100
indicating the percentage of
the maximum isoform expression per gene, for an alternate isoform
to be considered for detection.</p></td>
    </tr>
    <tr>
      <th>cutoffTxExpr</th>
      <td><p>numeric value indicating the minimum group mean
counts in <code>iMatrixTxGrp</code> for a transcript to be considered for
detection.</p></td>
    </tr>
    <tr>
      <th>cutoffTxTPMExpr</th>
      <td><p>numeric value indicating the minimum group mean
TPM in <code>iMatrixTxTPMGrp</code> for a transcript to be considered for
detection.</p></td>
    </tr>
    <tr>
      <th>useMedian</th>
      <td><p>logical indicating whether to use group median
values instead of group mean values.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating whether to print verbose output.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List with the following elements:</p><dl class='dl-horizontal'>
<dt>txExprGrpTx</dt><dd><p>Numeric matrix representing the expression
counts per transcript, grouped by <code>"gene_name"</code>.</p></dd>
<dt>txPctMaxGrpAll</dt><dd><p>Numeric matrix representing the
percent expression of each transcript isoform per gene, as
compared to the highest expression of isoforms for that gene.</p></dd>
<dt>txExprGrpAll</dt><dd><p>Numeric matrix of sample group counts,
exponentiated and rounded to integer values.</p></dd>
<dt>txTPMExprGrpAll</dt><dd><p>Numeric matrix of sample group TPM values,
exponentiated and rounded to integer values.</p></dd>
<dt>txFilterM</dt><dd><p>Numeric matrix indicating whether each isoform met
the criteria to be considered detected. The criteria must be
met in the same group for an isoform to be considered detected.</p></dd>
<dt>detectedTx</dt><dd><p>Character vector of transcripts, as defined by
the <code><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>rownames(iMatrixTx)</a></code>.</p></dd>
</dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function aims to combine evidence from RNA-seq sequence
read counts (or pseudocounts from a kmer tool such as Salmon or
Kallisto), along with alternative TPM quantitation, to determine
the observed "detected" transcript space for a given experiment.</p>
<p>Each input data matrix is assumed to be appropriately log-transformed,
typically using <code><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log2(1+x)</a></code>. If any value is <code>&gt;= 50</code> then the data
matrix will be log2-transformed using <code><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log2(1+x)</a></code>.</p>
<p>The criteria must be met in at least one sample group, but all
criteria must be met in the same sample group for an isoform to
be considered "detected".</p>
<p>In our experience the use of TPM values appears more robust and
is conceptually the best approach for comparing the relative
quantity of one transcript isoform to another. Our reasoning is
that TPM is intended to be roughly a molar quantity of transcript
molecules, independent of the transcript length, and the potential
for overlapping regions between isoforms. We also recommend the use
of a kmer quantitation method, such as Salmon or Kallisto, which
estimates isoform abundances not by specific read counts, but by
quantifying kmers unique to particular isoforms for a given gene.</p>
<p>In all cases, the thresholds for detection can be modified, however
from our experiences thus far the default values perform reasonably
well at identifying expressed isoforms, while filtering out isoforms
that we considered to be spuriously expressed.</p>
<p>There are three default requirements for a transcript to be considered
"detected".</p><ol>
<li><p>An isoform must be expressed at least 10<!-- % of the max isoform for -->
a given gene, using TPM values.</p></li>
<li><p>An isoform must have at least log2(32) pseudocounts to be considered
detected, based upon our view of Salmon pseudocount data using MA-plots.</p></li>
<li><p>An isoform must have at least log2(2) TPM units to be considered
detected, based upon our view of Salmon TPM values using MA-plots.</p></li>
</ol>
    <p>Each experiment is likely to be different in terms of total
sequenced reads, quality of read alignment or quantitation to the
transcriptome, etc. We suggest observing MA-plots for the counts and
TPM values, for the point at which the signal substantially increases
from baseline zero. We also plotted the TPM versus count per sample,
noted the point at which the two signals began to correlate. These
observations along with careful review of numerous gene model
transcript isoforms supported our selection of these criteria.</p>
<p>Lastly, the requirement for 10 percent of max isoform expression
was motivated by observing highly expressed genes, which sometimes had
alternative isoforms with extremely low abundance compared to the
most abundant isoform, but which was notably higher than the minimum
for detection. For example Gapdh expression above 100,000 pseudocounts,
may have an isoform with 120 pseudocounts. When we reviewed the sequence
coverage, we could find no compelling evidence to support the minor
isoform, and theorized that the pseudocounts arose from the stochastic
nature of rebalancing relative expression among isoforms.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other jam RNA-seq functions: <code><a href='ale2violin.html'>ale2violin</a></code>,
  <code><a href='codonUsage2df.html'>codonUsage2df</a></code>,
  <code><a href='detectedTxInfo.html'>detectedTxInfo</a></code>, <code><a href='dna2codon.html'>dna2codon</a></code>,
  <code><a href='groups2contrasts.html'>groups2contrasts</a></code>, <code><a href='jamCai.html'>jamCai</a></code>,
  <code><a href='makeTx2geneFromGtf.html'>makeTx2geneFromGtf</a></code>,
  <code><a href='runDiffSplice.html'>runDiffSplice</a></code>, <code><a href='sortSamples.html'>sortSamples</a></code>,
  <code><a href='tx2ale.html'>tx2ale</a></code></p></div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

